%
% exposit.tex
%    システム制御情報学会  Ａ４版クラスファイル
%    scitrans.cls のサンプル（解説・総説・展望記事のテンプレートファイル）
%
\documentclass[J]{scitrans}
\usepackage[dvipdfmx]{graphicx}
\graphicspath{{../../figs/}}

\usepackage{amsmath}
%\usepackage[whole]{bxcjkjatype}
%
%               Usage:  \documentclass[J]{scitrans} (和文の場合)
%                       \documentclass[E]{scitrans} (英文の場合)
%
% 年, 巻, 号 ページの設定
%
\UseRawInputEncoding
\appearyear{xxx}
\vol{xxx}
\numberinvol{xx}
\setcounter{page}{1}
\setcounter{volumepage}{1}

\Journal{解説}{『特集名』}{\expositry}      %% 解説の時
%%\Journal{総説}{『特集名』}{\survey}       %% 総説の時
%%\Journal{展望}{『特集名』}{\technicalview}%%  展望の時

%%\Journal{カテゴリ}{}      %% 特集号でない時は, 第2引数を空に

%%\ForSubmission            %% 提出前に一度コメントをはずして
                            %% 英文題目および著者名をご確認ください
\def\ddash{\rule[0.33zh]{2zw}{.03zh}}
\begin{document}

\title{埋め込み法が拓くネットワーク科学の新展開}
\author{幸若 完壮*}

\etitle{A New Paradigm for Network Science with Graph Embeddings}
\eauthor{Sadamori {\sc Kojaku}*}
\headingtitle{埋め込み法が切り拓くネットワーク分析の新展開}
\headingauthors{システム}

\maketitle

\acceptdate{xxx年xx月xx日}

\address{*}{Luddy School of Informatics, Computing, and Engineering, Indiana University Bloomington, USA}

\keywords{ネットワーク埋め込み法, 科学の科学, 機械学習}

%%% つぎの \input を削除し，本文を書き出して下さい．
%-----------------
\section{はじめに}
%-----------------
\label{sec:introduction}

友好関係、 銀行の融資関係、食物連鎖など社会や自然界のあらゆる場所にネットワークは存在する。
ネットワークは人間や銀行といった「モノ」と友好関係や取引関係といった「つながり」からなり、 
モノがお互いに影響を与え合うことで突発的で大規模な現象、例えば感染の拡大や倒産の連鎖、異常繁殖などの一因となっている\cite{}。
%ネットワークはモノ（頂点）とモノのつながり(枝)の集まりである。
%これらのつながりを介してモノとモノがお互いに影響しあい、 感染症の拡散や倒産の連鎖、生物の異常繁殖といった突発的で大規模な現象が引き起こる\cite{}。
%5例えば、 感染症は多くの人と接触機会を持つ人に伝わりやすく、その人を介してさらに多くの人に伝わることで爆発的な感染の連鎖が起こる\cite{}。

デジタル技術の進歩によって様々なネットワークがデータとして記録される一方で、その分析には超えるべき大きな障壁がある。
それは、ネットワークはモノやつながりの集まりではないため、一般的な手法でデータ分析しても十分な結果が得られないという障壁である。
例えば、ある感染症の感染疑いがある人を、人と人の接触データから見つける場合、感染者と接触した人を調べるだけでは不十分である。
なぜなら直接の接触がなくても、例えば共通の友人を介して感染することや、友人の友人、さらにその友人を介して感染する可能性もある。
そのため、感染疑いのある人を発見するためには個々の接触だけでなく、ネットワーク全体の接触関係を考えなくてはならない。
このように、ネットワークではつながりの組み合せが重要な意味を持つため、 ネットワーク分析のための専用の手法や理論が必要となる。

この障壁を解決する方法として、ネットワークをベクトルに圧縮変換する技術\ddash 埋め込み法\ddash が登場し、新たな展開を見せている。
埋め込み法は、 頂点をある空間上の点として捉えて、頂点の位置関係によってその複雑な関係を表現する手法である(図1)。
各頂点は位置を表すベクトルで表現されるため、ベクトルデータを入力とする様々な統計的・機械学習的なデータ分析法がネットワーク分析に利用可能となる。

本稿では、 埋め込み法が拓くネットワーク科学の新たな展開について概説する。
具体的に、 前半部では埋め込み法の代表的な手法とその応用例を紹介し基本的な考えと仕組みを説明する。
後半部では、 埋め込み法の応用事例として科学雑誌の引用ネットワークから学術分野のマップを作成した事例を紹介する。

\section{埋め込み法}

\subsection{自然言語処理と埋め込み法}

ネットワーク埋め込み法の元になっている埋め込み法は、もともと自然言語処理のために開発された手法である。
自然言語処理では、曖昧な人間の言語を機械で処理できる形にどのように変換するかが大きな課題の一つであった。
率直に考えれば、1つの単語に対して1つの数字を割り当てれば一応は数値化できる。
例えば、「値段は高いが質が低い料理」という文を「値段,高い,質,低い,料理」と区切って各単語に1つの数字を割り当てて「1,2,3,4,5」と表現する。
これは局所表現と呼ばれる単語の表現方法であるが、「高いの対義語は低いである」といった単語の関係を捉えられない。


\begin{figure}
    \centering
    \includegraphics[width=0.8\hsize]{baseball-map.pdf}
    \caption{
        プロ野球球団と都道府県の分散表現。
        可視化のために各単語の空間ベクトルの次元(300次元)を主成分分析によって2次元に減らした。
        点線は各球団と本拠地がある都道府県を示している。
        都道府県と球団が左右に分かれ、球団の上下の順序は本拠地のそれと大まかに対応している。
        単語の位置を得るため、国立国語研究所の日本語ウェブコーパス（NWJC）で学習させたWord2Vecを用いた\protect\cite{kawamura2020chive}。
    }
    \label{fig:baseballmap}
\end{figure}

この局所表現の欠点を解決したのが「分散表現」だ。
分散表現は、各単語をベクトル空間上の点と捉え、単語同士の意味的な関係を空間上の位置関係で表現する。
例えば、プロ野球球団と都道府県名を分散表現で記述しよう(図1)。球団同士、都道府県同士を近くに配置することで「球団」と「都道府県」の区別を表現できる。
さらに、単語の位置べクトルを直接演算することで様々な推論をすることができる。
例えば、「北海道」と「ファイターズ」という関係は
\begin{align}
    v({\rm 北海道}) + v({\rm 球団}) = v({\rm ファイターズ})
\end{align}
と書くことができる。 ここで単語$w$のベクトルを$v(w)$とした。
したがって「福岡の球団は？」という問いの答えは
$v({\rm 福岡}) + v({\rm 球団}) = v({\rm 福岡}) + v({\rm ファイターズ}) - v({\rm 北海道})$で与えられ、
この答えが$v({\rm ホークス})$に大体一致する。

分散表現は膨大な単語の配置を決定する難しさや計算量が大きいといった実用上の課題のため実践が進まなかった。
これらの課題を解決し、自然言語処理に大きな進展をもたらした手法が「Word2Vec」である。
図1の分散表現もWord2Vecによって得られたものである。

\subsection{Word2Vec}

Word2Vecは2層で構成されるニューラルネットワークである(図2)。
入力層は文章中の単語、出力層は周辺に現われる単語、そして中間層が入力単語の分散表現である\footnote{これはSkip-gram法と呼ばれるWord2Vecの1つの手法である。Word2Vecの別の手法として、各単語を出力、周辺語を入力とするCBOW(Continuous Bag-of-Words)法がある\cite{Mikolov2013}。}。

この手法の重要なポイントは出力層である周辺の単語である。
周辺の単語が近しければ、中間層である分散表現も近しい。言い換えれば、Word2Vecで得られる分散表現では、使われる文脈が似ている単語は近くに配置されるのである。
例えば、図1の球団名は似たような文脈で使われるため近くに配置されるのである。

Word2Vecは情報圧縮装置と見ることもできる。
Word2Vecの入力は単語であるが、実際には単語の記号の代わりに高次元のベクトルを入力する。
このベクトルでは1つの要素が``1''で他の全てが要素が``0''であり、``1''が出現する場所で入力単語を表現する。
そのため、単語が$N$個あれば入力ベクトルの長さは$N$である。
この高次元ベクトルは入力層から中間層に渡ってより小さな次元のベクトルに「圧縮」され、その後に中間層から出力層に渡って文脈を表すベクトルに変換される。
この圧縮されたベクトルが入力単語の分散表現である。

Word2Vecの興味深い活用例を1つ紹介しよう。
研究\cite{Tshitoyan2019}では材料科学に関する約330万本の論文の要旨をWord2Vecに学習させ、様々な材料の分散表現を構築した。
この「材料空間」は、様々な物性、例えば元素の周期表、物質の強磁性、熱電特性、結晶構造の類似性などを捉えている。
また、材料の位置ベクトルを演算して、$v({\rm AI}_2{\rm O}_3) - v({\rm AI}) + v({\rm Si}) = v({\rm SiO}_2)$といった物質の反応や、
$v({\rm 二重六方最密構造}) - v({\rm La}) + v({\rm Cr}) = v({\rm 体心立方格子構造})$といった結晶構造の関係を推論することができる。
さらに、Word2Vecは過去の論文の要旨から当時は未発見の材料の特性を、2から4割程度の精度で正しく予言したのである。

Word2Vecの登場によって自然言語処理は大きく進展した。
Word2Vecはその後様々な改良が加えられ\cite{Levy2014,pennington-etal-2014-glove,joulin2016fasttext,Bojanowski2017}、無償で利用できるパッケージにまとまっている\cite{gensim}。

\subsection{グラフ埋め込み法}

Word2Vecなどの自然言語の埋め込み法を応用して頂点を埋め込む手法が、これから紹介する「グラフ埋め込み法」である。

ネットワークの頂点の関係は、関係が未知な単語と異なり、枝で明確に表現されている。
ではネットワークに埋め込み法を適用すると何が嬉しいのだろうか？
頂点は直接つながっている頂点と関係を持つと同時に、直接つながっていない頂点とも関係を持つ。
例えば「敵の敵は味方」ということわざがある。自分（頂点）にとって直接的な敵対関係（枝）にある敵と敵対関係にある別の誰かは、たとえ自分と直接的な関係がなくても、味方という間接的な関係を持つ。
ある頂点と枝でつながる頂点はネットワーク全体から見ると少数である。
一方で、直接つながっていない頂点は数多くあり、それら頂点との関係は単語の関係と同じように非自明である。
グラフ埋め込み法は、頂点の関係を枝ではなく空間上の位置関係で表現する手法である。
枝で直接つながっていない頂点対であっても、配置されている距離や方向から、関係の強さや種類を調べることができる。
そしてこれらの分析は簡単なベクトル演算で行うことができる。

ではどうやって頂点を埋め込むのだろうか？
ここではネットワーク埋め込み法の先駆けであるDeepWalkについて紹介する。
自然言語処理で発展した埋め込み法は、文章が入力であるので、当然ながらネットワークを入力として受け付けない。
この問題を解決し、ネットワークに自然言語処理の埋め込み法を適用できるようにしたのがDeepWalk\cite{Bryan2014}である。

DeepWalkでは、各頂点を1つの単語として、頂点の列（文）をネットワークから生成する。
生成する文がある頂点$i$から始まるとしよう。DeepWalkでは、$i$の次に来る頂点を隣接する頂点の中から確率的に選ぶ。
これを繰り返し行うことで、頂点を単語とする文を生成する。
あとはこの生成された文をWord2Vecに与えれば、頂点の埋め込みが得られる。
この「ある頂点から別の頂点を確率的に選んで移動する運動」はネットワークにおけるランダム・ウォークと呼ばれる。
ランダム・ウォークには様々な種類があり、別種のランダム・ウォークを利用したネットワーク埋め込み法も提案されている\cite{Grover2016,Dong2017}。

では実際にネットワークを埋め込んでみよう。
Openflight.orgのデータを元に空港ネットワークを構築し、これをDeepWalkで128次元の空間に埋め込む。
DeepWalkの学習には行列分解法\cite{Qiu2018}を用い、可視化のためLinear Discrimination Analysisを用いて2次元に射影した(図\ref{fig:airport})。
DeepWalkで生成された埋め込み空間には、大まかにアジア、アメリカ、ヨーロッパの3つの地域の空港から成るクラスターがある。
各クラスターの境界には地域を結ぶ空港があり、空港の位置から空港の機能が見て取れる。
さらに、各空港は円状に広がっている。これは空港が球体である地球表面にあるからかもしれない。
%
%\subsection{埋め込み空間の分析ツール}
%% 時間があれば
%埋め込み空間は多くの場合高次元であり、可視化が困難である。


%- なぜ埋め込みか
%    - NLPの要請に触れておく
%- どうやって埋め込む？
%　  - Neural Netで図的な解説
%    - 情報圧縮と解凍
%- 自然言語処理での成功例
%    - Analogy test
%    - Material2Vec
%- Networkの埋め込み
    - Grapから文の生成
- Airport netでの応用

\section{科学の地図を作る}

- Journal2Vec
- Translational axis




%-----------------
\section{おわりに}
%-----------------


% 謝辞
%------------------
\acknowledgement
%-----------------



\authorbiography{幸,若,　,完,壮}{こう,じゃく,,さだ,もり}{非正会員}{%
 2015年9月××大学大学院工学研究科○○工学専攻△△課程修了．
 同年X月××助手．19XX年X月××となり現在に至る．
 ××の研究に従事．
 ××などの会員．}

%\authorbiography{佐,藤,　,花,子}{さ,とう,,はな,こ}{正会員}{%
%  19XX年X月××大学大学院工学研究科○○工学専攻△△課程修了．
%  同年X月××助手．19XX年X月××となり現在に至る．
%  ××の研究に従事．
%  ××などの会員．}

%\authorbiography{田,中,　,次,郎}{た,なか,,じ,ろう}{正会員}{%
%  19XX年X月××大学大学院工学研究科○○工学専攻△△課程修了．
%  同年X月××助手．19XX年X月××となり現在に至る．
%  ××の研究に従事．
%  ××などの会員．}

\end{document}
%
%% end of exposit.tex
